---
// src/components/LoopComponents/MenuItem.astro

// (NO imports from astro:content or CollectionQueryUtils here)

const { item, itemClass = "" } = Astro.props;
import SubMenu from "@/components/SubMenu.astro";

// We no longer compute `hasChildren` here.  Instead, we always render <SubMenu>,
//  letting it be empty when there are no children.
---

<li class={`relative menu-item ${itemClass}`}>
  <a
    href={item.data.link}
    class="flex items-center space-x-[var(--spacing-xs)]
           text-md text-primary hover:text-secondary
           transition-colors duration-200 font-bold"
    rel="noopener noreferrer"
  >
    {item.data.icon && (
      <img
        src={item.data.icon}
        alt=""
        class="w-5 h-5 bg-[var(--color-accent)] rounded-full"
      />
    )}
    <span>{item.data.title}</span>

    <!-- Always show the “▼” arrow.  If SubMenu renders no children, you’ll get no dropdown. -->
    <span
      class="submenu-arrow ml-1 transform transition-transform duration-200 group-hover:rotate-180"
      aria-hidden="true"
    >
      ▼
    </span>
  </a>

  <!-- SubMenu is just an <ItemsTemplate query="children" …> under the hood -->
  <SubMenu parentLink={item.data.link} />
</li>
