---
import ItemsTemplate from "@/components/Section/ItemsTemplates/ItemsTemplate.astro";
import MenuItem from "./MenuItem.astro";

const {
  parentLink,

  /* same object we got from MenuItem above */
  submenu = {
    component: MenuItem,
    itemsClass: "",
    subMenuItem: {
      component: MenuItem,
      props: {
        itemClass: "",
        linkClass: "",
        hierarchical: true,
        subMenuItem: null,
      },
    },
  },
} = Astro.props;

// Derive “services”, “blog”, etc. from that parentLink
const thisSlug = parentLink.split("/").filter(Boolean).pop() ?? "";
---

<ItemsTemplate
  collection="menuItems"
  query="children"
  pathname={thisSlug}
  ItemComponent={{
    component: submenu.subMenuItem.component ?? MenuItem,
    props: {
      ...submenu.subMenuItem.props,
      submenu: submenu /* pass our object further for deeper nesting */,
    },
  }}
  itemsClass={submenu.itemsClass}
  itemClass=""
  HasPage={false}
/>
