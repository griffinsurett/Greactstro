---
import ItemsTemplate from "@/components/ItemsTemplates/ItemsTemplate.astro";
import MenuItem      from "./MenuItem.astro";

const {
  /* Supplied by parent MenuItem */
  allItems = [],
  parentId,
  childItems = [],
  collectionName,
  /* Submenu descriptor passed down the chain */
  submenu = {
    component: MenuItem,
    itemsClass: "",
    subMenuItem: {
      component: MenuItem,
      props: {
        itemClass: "",
        linkClass: "",
        hierarchical: true,
        subMenuItem: null,
      },
    },
  },
} = Astro.props;
---

{childItems.length ? (
  <ItemsTemplate
    collection={collectionName} 
    items={childItems}
    itemsClass={`submenu ${submenu.itemsClass}`}
    itemClass=""
    role="menu"
    /* Render each child with the correct component/props */
    ItemComponent={{
      component: submenu.subMenuItem.component ?? MenuItem,
      props: {
        ...submenu.subMenuItem.props,
        allItems,
        submenu,               
      },
    }}
    HasPage={false}
  />
) : null}
